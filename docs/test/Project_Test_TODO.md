# 入札公告要件判定システム - テスト実装TODO

## 関連ドキュメント
- **テスト仕様書**: `/docs/test/Project_Test.md`
- **テストケース表**: `/docs/test/Project_TestCase.md`
- **設計書**: `/docs/design/Project_design.md`
- **要件定義書**: `/docs/requirements/要件定義書.md`
- **プロジェクトTODO**: `/docs/todo/Project_TODO.md`

---

## 優先度凡例
- 🔴 Critical: システム停止やデータ破損に関わる重要テスト
- 🟡 High: 主要機能の動作確認に必要なテスト
- 🟢 Medium: 補助機能や例外処理のテスト
- ⚪ Low: UI改善や最適化に関するテスト

---

## 1. テスト環境構築 【優先度: 🔴】

### 1.1 テスト用スプレッドシート準備
- [ ] 本番マスターデータのコピー作成
- [ ] テスト用シート構造の作成
  - [ ] 判定前公告一覧（テスト用）
  - [ ] 判定後公告一覧（テスト用）
  - [ ] ログシート（テスト用）
- [ ] テスト実行権限の設定

### 1.2 テストデータ準備
- [ ] 企業マスターテストデータ（50社）
  - [ ] 正常企業データ（30社）
  - [ ] 欠格企業データ（20社）
- [ ] 拠点マスターテストデータ（100件）
  - [ ] 全国都道府県カバー
  - [ ] 複数拠点パターン
- [ ] 従業員マスターテストデータ（200名）
  - [ ] 各種資格保有パターン
  - [ ] 配置可能/不可パターン
- [ ] 実績マスターテストデータ
  - [ ] 金額別実績データ
  - [ ] 期間別実績データ
  - [ ] 工事成績データ

### 1.3 モックサービス準備
- [ ] OCR APIモックの実装
  - [ ] 正常レスポンス
  - [ ] エラーレスポンス
  - [ ] タイムアウトシミュレーション
- [ ] LLM APIモックの実装
  - [ ] 要件抽出結果の固定化
  - [ ] エラーケース

---

## 2. 単体テスト実装 【優先度: 🟡】

### 2.1 共通モジュールテスト (Utils.ts)
- [ ] `convertToHalfWidth()`関数テスト
  - [ ] T-UT-001: 全角英数字変換
  - [ ] T-UT-002: 全角スペース変換
  - [ ] T-UT-003: 混在文字列変換
- [ ] `parseDate()`関数テスト
  - [ ] T-UT-004: 標準形式パース
  - [ ] T-UT-005: 全角数字形式パース
  - [ ] T-UT-006: 和暦形式パース
  - [ ] T-UT-007: 月日のみパース
  - [ ] T-UT-008: 不正日付処理

### 2.2 データアクセス層テスト (MasterDataAccess.ts)
- [ ] `getCompanyById()`関数テスト
  - [ ] T-UT-011: 存在する企業ID検索
  - [ ] T-UT-012: 存在しない企業ID検索
  - [ ] T-UT-013: 空値エラー処理
- [ ] `checkDisqualification()`関数テスト
  - [ ] T-UT-014: 欠格フラグなし
  - [ ] T-UT-015: 破産フラグあり
  - [ ] T-UT-016: 複数欠格フラグ

### 2.3 判定エンジンテスト
#### 欠格要件判定 (DisqualificationJudge.ts)
- [ ] `judgeDisqualification()`関数テスト
  - [ ] T-UT-017: 全条件クリア
  - [ ] T-UT-018: 単一欠格要件
  - [ ] T-UT-019: 複数欠格要件

#### 等級要件判定 (GradeJudge.ts)
- [ ] `checkGradeRequirement()`関数テスト
  - [ ] T-UT-020: 等級要件一致
  - [ ] T-UT-021: 等級要件不足
  - [ ] T-UT-022: 以上条件判定

#### 地域要件判定 (RegionJudge.ts)
- [ ] `checkRegionRequirement()`関数テスト
  - [ ] T-UT-023: 地域要件一致
  - [ ] T-UT-024: 地域要件不一致
  - [ ] T-UT-025: 複数拠点判定

#### 実績要件判定 (AchievementJudge.ts)
- [ ] `checkAchievementRequirement()`関数テスト
  - [ ] T-UT-026: 実績要件満足
  - [ ] T-UT-027: 実績要件不足
  - [ ] T-UT-028: 工事成績要件

#### 技術者要件判定 (EngineerJudge.gs)
- [ ] `checkEngineerRequirement()`関数テスト
  - [ ] T-UT-029: 必要資格保有
  - [ ] T-UT-030: 必要資格なし
  - [ ] T-UT-031: 同等資格判定

### 2.4 外部連携テスト (OCRConnector.gs)
- [ ] `sendToOCR()`関数テスト
  - [ ] T-UT-032: 正常PDF処理
  - [ ] T-UT-033: 無効URL処理
  - [ ] T-UT-034: タイムアウト処理

---

## 3. 結合テスト実装 【優先度: 🟡】

### 3.1 ワークフロー結合テスト
- [ ] T-IT-001: 単一公告の完全処理フロー
  - [ ] 転記処理の動作確認
  - [ ] OCR処理の連携確認
  - [ ] 判定処理の実行確認
  - [ ] レポート生成確認
- [ ] T-IT-002: 100件バッチ処理
  - [ ] バッチ分割ロジック確認
  - [ ] 進捗管理機能確認
  - [ ] 全件処理完了確認

### 3.2 タイムアウト処理テスト
- [ ] T-IT-003: タイムアウトと再開
  - [ ] 5分でのタイムアウト確認
  - [ ] トリガー設定確認
  - [ ] 再開処理の正確性確認
- [ ] T-IT-004: 複数回タイムアウト
  - [ ] 状態管理の永続性確認
  - [ ] 処理重複防止確認

### 3.3 エラーハンドリングテスト
- [ ] T-IT-005: OCRエラー時の処理継続
  - [ ] エラーログ記録確認
  - [ ] 後続処理の継続確認
- [ ] T-IT-006: マスターデータ不整合
  - [ ] エラーデータスキップ確認
  - [ ] 正常データ処理確認

---

## 4. システムテスト実装 【優先度: 🟡】

### 4.1 エンドツーエンドテスト
- [ ] T-ST-001: 新規ユーザーの初回利用
  - [ ] 初期設定フロー確認
  - [ ] サンプルデータ実行
  - [ ] 結果確認プロセス
- [ ] T-ST-002: 大量データ処理（200件）
  - [ ] メモリ使用量監視
  - [ ] 処理時間測定
  - [ ] エラー率確認

### 4.2 性能テスト
- [ ] T-ST-003: 処理時間測定
  - [ ] 1件あたり平均時間（目標: 30秒以内）
  - [ ] 100件バッチ総時間（目標: 60分以内）
  - [ ] API応答時間（目標: 3秒以内）
- [ ] T-ST-004: 同時実行テスト
  - [ ] 5ユーザー同時実行シミュレーション
  - [ ] リソース競合確認
  - [ ] デッドロック防止確認

---

## 5. 受入テスト準備 【優先度: 🟢】

### 5.1 業務シナリオテスト準備
- [ ] T-UAT-001: 実公告判定テスト
  - [ ] 実際の入札公告10件準備
  - [ ] 判定結果検証シート作成
  - [ ] ユーザー評価基準設定
- [ ] T-UAT-002: 日常運用シミュレーション
  - [ ] 1週間分の運用シナリオ作成
  - [ ] 運用手順書ドラフト作成

### 5.2 ユーザビリティテスト準備
- [ ] T-UAT-003: UI/UX評価
  - [ ] 評価チェックリスト作成
  - [ ] ユーザーフィードバック収集フォーム
  - [ ] 改善提案記録シート

---

## 6. テスト自動化 【優先度: 🟢】

### 6.1 テストフレームワーク構築
- [ ] Google Apps Script Test Framework導入
- [ ] テストランナーの実装
- [ ] テスト結果レポート機能

### 6.2 CI/CD連携
- [ ] テスト自動実行トリガー設定
- [ ] テスト結果通知機能
- [ ] 回帰テスト自動化

---

## 7. ドキュメント整備 【優先度: ⚪】

### 7.1 テストドキュメント
- [ ] テスト実施手順書作成
- [ ] テスト結果記録テンプレート
- [ ] 不具合管理表テンプレート

### 7.2 運用ドキュメント
- [ ] テスト環境構築手順書
- [ ] テストデータ管理手順書
- [ ] トラブルシューティングガイド

---

## 8. 品質保証活動 【優先度: 🟢】

### 8.1 コードレビュー
- [ ] 単体テストコードレビュー
- [ ] 結合テストシナリオレビュー
- [ ] テストカバレッジ確認

### 8.2 品質メトリクス
- [ ] テストカバレッジ目標: 80%以上
- [ ] 不具合密度目標: Critical 0件
- [ ] 性能基準達成率: 100%

---

## 実施スケジュール（推奨）

### Phase 1: 基盤構築（1週目）
- テスト環境構築
- テストデータ準備
- モックサービス実装

### Phase 2: 単体テスト（2-3週目）
- 共通モジュールテスト
- データアクセス層テスト
- 判定エンジンテスト

### Phase 3: 結合テスト（4週目）
- ワークフロー結合テスト
- エラーハンドリングテスト

### Phase 4: システムテスト（5週目）
- エンドツーエンドテスト
- 性能テスト

### Phase 5: 受入準備（6週目）
- UAT環境準備
- ユーザー向けドキュメント作成

---

## 改訂履歴
- 2024-01-XX: 初版作成（テスト仕様書・テストケース表から生成）