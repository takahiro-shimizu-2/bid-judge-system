まずは苦労の説明をしますユーザーは判定前広告一覧二入力をしますするとユーザーはカスタムメニュー入札効果判定ところで一括実行を押すとええ次のようにワークフローが流れます判定売国一覧から入札公告マスターに情報が提出されますそしてその入札公告マスターからOCRの外部ツールえっデータが終わったされますそのデータを受け入札公告マスターおよび報告要件マスターが更新されますそれが終わるとええ国マスターの要件種別で各用件ごとにどの分類に当てはまるかを要件種別を分類します
その後今度は企業広告判定マスターに安定している広告と拠点マスターに登録されている企業分幕を作成します枠セット完了したらいよいよ分類を開始します
ますその分類されたことをもとに欠格要件に該当しているものに関しては企業マスターを参照し企業マスター上の欠格要件自由に登録がない場合はすべてクリアとして扱いますある場合はNgとして扱います。問題がない場合は迅速用件リストマスターに情報を登録し問題がある場合には不足要件リストマスターに情報登録しますこの時の判定連番は広告かけるええ各企業の拠点単位で順番に番号を振るイメージです欠格要件の場合用件ように 1から振っていくイメージです。欠格要件についてはここで一括で各広告×拠点毎に欠格要件に〇×をセットします。NGの場合は「[欠格]～」（～はNG内容）を不足要件メッセージまとめに記載していきます。そして最終ステータスをNG有に更新します。
続いて結局用件以外の要件については今度は要件拠点中間テーブル二要件かける拠点ごとに登録して行きますでええ登録が終わったら今度はいよいよ用件判定になってええそれぞれの内容に合わせ各マスター上その要件を満たしているかどうかを判定して行きます。この判定結果の反映は要件拠点中間提案一行ずつ反映させていきます要はその判定が終わったらその都度充足用件リストマスター不足用件リストマスター企業広告判定マスターに反映させていくということになります。充足用件リストマスター即用件リストマスターについてはまあ先ほど同様オッケーなものが充足用件リストマスター不足用件リストマスターはNgのものが入りますそれぞれの項目についてはマスターにあるとうりに従い入力して行きます記憶判定マスターも西多賀項目に従って行きますなので該当する用件ごとに更新をかけていきます Ngがある場合不足用件メッセージまとめにメ問題のある内容を記載し最終ステータスをNgありに変更します不足用件メッセージまとめはこれ上書きではなくてすでに内容を書いてある場合には更新してNg内容をどんどん追加して行くという方式を取ります
そして欠格要件等級要件地域用件実績用件技術者要件その他用件すべて丸いなっているものに関しては最終ステータスに「ALL CLEAR」を入力します。
最後に報告用のシート作成行います。シート目は報告表シート。各シートが必要情報を取得して報告用シートを完成させます
これが一連のワークフローになります


まずユーザーは判定前公告一覧に入力を行います。
必須入力項目は a列の判定枚広告IDと B列の工事名そしてD列の象徴名（最上位発注機関） E列の実発注機関名、 J列の PDF URLですそして任意入力項目として C列の広告番号とFからI列です。
その入力内容を入札公告マスターで受け配置します入札公告マスターの具体的な内容は入札公告連番は自動付番工事名は先ほどの工事名、広告番号は入力あった場合は先ほどの国番号なければ空白、発注機関連番（省庁）は 先ほどの最上位発注機関省庁名に記載された内容が発注機関マスターに登録がある場合その発注機関マスターに登録されているその発注機関の発注機関連番を取得します象徴名（再発注機関は先ほど入力した入力あればその記載を転写してくださいそして次発注機関電波（発注機関については先程入力した地域間名がある場合はセキュリティーを発注機関マスターから回答する発注機関名を検索し発注機関連番を取得してくださいそしてAG列の実発注機関名二環先ほど入力があった場合は自殺機関名がそれを転写してください次工事場所は OCR結果から出力されますので取得してください次広告PD URLは先ほどの入力あった系列のピーディーエフURLを検索してくださいええ次 J列からP列までは外部ツールによるOCR結果を受けるのでそれを書く内容をそれぞれ適切な配置に並べて入れてください外部からその項目名で渡されてくるんで入れてねっていうことです九列から Wに関しては先ほどのFかあいつの内容をそれぞれあった適切な場所に電車してくださいもしくわ外部ツールから渡されている場合はその外部ツール解除を受けてください優先順位は十社です判定前広告一覧に入力した内容が優先されそれが空欄の場合は外部ツールそのOCR結果から受けるようにしてくださいそしてええ外部ツールでOCRが実施が終わったものに関してはエックス列のオーシーリアル自主フラグこれはチェックボックスが用意されているのでそのチェックボックスをチェックを付けた状態にしてください次へへOCN実行が終わった時に更新日時を入れてください先ほど言い忘れましたがほかの項目をシェアするまでの電車処理で作成日時Z列を入力してくださいなので順番としては判定航空一覧から入札公告マスターへ一度情報が提示されてそこからの入札公告マスターからええ外部ツールのオーシーアールへデータが渡されOCR完了したら入札公告マスターへ情報が渡るまた航空用件マスターに用件が登録されるという流れになります
広告マスターはもしR完了したら外部ツールが配列で確かええデータ返してくると思ったのでええそれを受けでくださいうんマスター数字で書く内容は端子の説明にあるんで見てください
転写処理が終わったら書く内容に合わせ要件種別の分類してください要件種別は欠格要件、業種・等級要件、地域要件、実績要件、技術者要件、JV要件があります。（JV要件は将来実装予定）
各要件の細かいところは現Masterをベースに別紙2を参照（別紙2は古い可能性があるため現Masterを優先）
分類が完了したら中間ファイル登録を実施し、一件一件判定を実施。
判定結果を書き込みし、結果報告用シートを作成。

複数人同時実行を想定。サーバー側とクライアント側を分離。サーバー側はライブラリーにする。
セキュリティ面を考慮し、中核処理及びAPIはサーバー側に登録、ワークフロー状態の管理（ワークフロー処理自体はサーバー側）はクライアント側、つまりワークフローの進捗状況にサーバー側のシートやスクリプトプロパティを使わない。但しできない場合はサーバー側シートを使用。サーバー側でスプシに張り付いたGASを使えない場合はスタンドアロンも作成して使用。基幹マスターはサーバー側、それ以外の入力や要件判定等の動的に変化していくシートはクライアント側
基幹マスターはこれかなと思っている。
# M_AGENCY (発注者機関マスター)
# M_CONSTRUCTION_TYPE (営業品目マスター)
# M_QUALIFICATION (技術者資格マスター)
# M_COMPANY (企業マスター)
# M_OFFICE (拠点マスター)
# T_OFFICE_LICENSE (拠点登録許可マスター)
# M_EMPLOYEE (従業員マスター)
# T_EMPLOYEE_QUAL (従業員資格マスター)
# T_OFFICE_EXPERIENCE (拠点工事実績マスター)
# T_EMPLOYEE_EXPERIENCE (従業員工事経験マスター)

